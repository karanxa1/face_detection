<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human Detection System</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1); max-width: 800px; margin: auto; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { padding: 10px 20px; cursor: pointer; background: none; border: none; font-size: 16px; color: #666; }
        .tab.active { color: #007bff; border-bottom: 2px solid #007bff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        button { padding: 10px 20px; font-size: 16px; color: white; background-color: #007bff; border: none; cursor: pointer; margin: 10px; }
        button:hover { background-color: #0056b3; }
        .video-container { margin-top: 20px; }
        video { width: 100%; max-height: 80vh; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Human Detection System</h1>

        <div class="tabs">
            <button class="tab active" data-tab="camera">Live Camera</button>
            <button class="tab" data-tab="upload">Upload Video</button>
        </div>

        <div id="camera-tab" class="tab-content active">
            <button id="start-camera">Start Camera</button>
            <button id="stop-camera">Stop Camera</button>
            <div class="video-container">
                <img id="camera-feed" src="{{ url_for('video_feed') }}" width="100%">
            </div>
        </div>

        <div id="upload-tab" class="tab-content">
            <input type="file" id="video-upload" accept="video/*">
            <button id="process-video">Process Video</button>
            <div class="video-container">
                <video id="processed-video" controls></video>
            </div>
        </div>
    </div>

    <script>
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
            });
        });

        document.getElementById('stop-camera').addEventListener('click', () => {
            fetch('/stop_camera', { method: 'POST' });
        });

        document.getElementById('process-video').addEventListener('click', async () => {
            const fileInput = document.getElementById('video-upload').files[0];
            if (!fileInput) return alert("Please upload a video first.");

            let formData = new FormData();
            formData.append("video", fileInput);

            let response = await fetch('/upload_video', { method: "POST", body: formData });
            let data = await response.json();
            if (data.processed_video) {
                document.getElementById('processed-video').src = data.processed_video;
            }
        });
    </script>
</body>
</html>
